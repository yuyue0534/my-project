<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VOID RUNNER™ — 限定发售</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Mono:wght@300;400;500&display=swap');

:root {
  --bg: #0a0a0a;
  --bg-elevated: #111111;
  --surface: #1a1a1a;
  --cream: #f0ebe3;
  --cream-dim: #8a857e;
  --accent: #ff4d00;
  --accent-glow: rgba(255, 77, 0, 0.15);
  --success: #2ecc71;
  --font-display: 'Bebas Neue', sans-serif;
  --font-serif: 'Cormorant Garamond', serif;
  --font-mono: 'DM Mono', monospace;
}

*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

html {
  scroll-behavior: smooth;
  scrollbar-width: thin;
  scrollbar-color: var(--accent) var(--bg);
}
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: var(--bg); }
::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 2px; }

body {
  background: var(--bg);
  color: var(--cream);
  font-family: var(--font-serif);
  -webkit-font-smoothing: antialiased;
  overflow-x: hidden;
}

/* ═══ Custom Cursor ═══ */
.cursor-dot {
  position: fixed;
  width: 6px; height: 6px;
  background: var(--accent);
  border-radius: 50%;
  pointer-events: none;
  z-index: 10000;
  transform: translate(-50%, -50%);
  transition: transform 0.1s;
  mix-blend-mode: difference;
}
.cursor-ring {
  position: fixed;
  width: 36px; height: 36px;
  border: 1.5px solid var(--cream);
  border-radius: 50%;
  pointer-events: none;
  z-index: 10000;
  transform: translate(-50%, -50%);
  transition: width 0.3s, height 0.3s, border-color 0.3s;
  mix-blend-mode: difference;
}
.cursor-ring.hover {
  width: 56px; height: 56px;
  border-color: var(--accent);
}

/* ═══ Navigation ═══ */
nav {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 100;
  padding: 24px 40px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  mix-blend-mode: difference;
}
.nav-logo {
  font-family: var(--font-display);
  font-size: 1.4rem;
  letter-spacing: 6px;
  color: var(--cream);
  text-decoration: none;
}
.nav-links { display: flex; gap: 32px; list-style: none; }
.nav-links a {
  font-family: var(--font-mono);
  font-size: 0.7rem;
  font-weight: 400;
  color: var(--cream-dim);
  text-decoration: none;
  letter-spacing: 2px;
  text-transform: uppercase;
  transition: color 0.3s;
  position: relative;
}
.nav-links a::after {
  content: '';
  position: absolute;
  bottom: -4px; left: 0;
  width: 0; height: 1px;
  background: var(--accent);
  transition: width 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}
.nav-links a:hover { color: var(--cream); }
.nav-links a:hover::after { width: 100%; }

/* ═══ Hero Section ═══ */
#hero {
  position: relative;
  height: 100vh;
  display: flex;
  align-items: center;
  overflow: hidden;
}
.hero-bg-text {
  position: absolute;
  font-family: var(--font-display);
  font-size: clamp(12rem, 22vw, 28rem);
  color: transparent;
  -webkit-text-stroke: 1px rgba(240, 235, 227, 0.04);
  line-height: 0.85;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  white-space: nowrap;
  pointer-events: none;
  user-select: none;
}
.hero-content {
  position: relative;
  z-index: 2;
  padding: 0 6vw;
  width: 45%;
}
.hero-label {
  font-family: var(--font-mono);
  font-size: 0.65rem;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: 20px;
  opacity: 0;
  transform: translateY(20px);
  animation: fadeUp 0.8s 0.5s forwards;
}
.hero-title {
  font-family: var(--font-display);
  font-size: clamp(3.5rem, 7vw, 7rem);
  line-height: 0.92;
  letter-spacing: 4px;
  margin-bottom: 24px;
  opacity: 0;
  transform: translateY(30px);
  animation: fadeUp 0.8s 0.7s forwards;
}
.hero-subtitle {
  font-family: var(--font-serif);
  font-size: clamp(1rem, 1.5vw, 1.3rem);
  font-weight: 300;
  font-style: italic;
  color: var(--cream-dim);
  line-height: 1.7;
  max-width: 360px;
  margin-bottom: 40px;
  opacity: 0;
  transform: translateY(30px);
  animation: fadeUp 0.8s 0.9s forwards;
}
.hero-price-row {
  display: flex;
  align-items: baseline;
  gap: 16px;
  margin-bottom: 36px;
  opacity: 0;
  animation: fadeUp 0.8s 1.1s forwards;
}
.hero-price {
  font-family: var(--font-display);
  font-size: 2.2rem;
  letter-spacing: 2px;
}
.hero-price-note {
  font-family: var(--font-mono);
  font-size: 0.6rem;
  color: var(--accent);
  letter-spacing: 2px;
  text-transform: uppercase;
}

@keyframes fadeUp {
  to { opacity: 1; transform: translateY(0); }
}

/* ═══ 3D Viewer ═══ */
#viewer-container {
  position: absolute;
  right: 0; top: 0;
  width: 55%; height: 100%;
  z-index: 1;
}
#viewer-container canvas { display: block; }

.viewer-hint {
  position: absolute;
  bottom: 60px; right: 50%;
  transform: translateX(50%);
  font-family: var(--font-mono);
  font-size: 0.6rem;
  letter-spacing: 3px;
  color: var(--cream-dim);
  text-transform: uppercase;
  opacity: 0;
  animation: fadeUp 0.8s 1.5s forwards;
  pointer-events: none;
}
.viewer-hint span {
  display: inline-block;
  width: 24px; height: 24px;
  border: 1px solid var(--cream-dim);
  border-radius: 50%;
  text-align: center;
  line-height: 22px;
  margin-right: 8px;
  font-size: 0.9rem;
  animation: pulse-ring 2s infinite;
}
@keyframes pulse-ring {
  0%, 100% { opacity: 0.5; transform: scale(1); }
  50% { opacity: 1; transform: scale(1.1); }
}

/* ═══ Scroll Indicator ═══ */
.scroll-indicator {
  position: absolute;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 10;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  opacity: 0;
  animation: fadeUp 0.8s 1.8s forwards;
}
.scroll-line {
  width: 1px;
  height: 40px;
  background: linear-gradient(to bottom, var(--cream-dim), transparent);
  animation: scroll-pulse 2s infinite;
}
@keyframes scroll-pulse {
  0% { transform: scaleY(0); transform-origin: top; }
  50% { transform: scaleY(1); transform-origin: top; }
  51% { transform-origin: bottom; }
  100% { transform: scaleY(0); transform-origin: bottom; }
}

/* ═══ Story Section ═══ */
.story-section {
  position: relative;
  padding: 140px 6vw;
  overflow: hidden;
}
.story-section::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(240,235,227,0.08), transparent);
}

.section-number {
  font-family: var(--font-display);
  font-size: clamp(6rem, 12vw, 14rem);
  color: transparent;
  -webkit-text-stroke: 1px rgba(255, 77, 0, 0.12);
  position: absolute;
  right: 6vw; top: 80px;
  line-height: 1;
  pointer-events: none;
}

.story-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 80px;
  align-items: center;
  max-width: 1200px;
  margin: 0 auto;
}
.story-grid.reverse { direction: rtl; }
.story-grid.reverse > * { direction: ltr; }

.story-text {
  opacity: 0;
  transform: translateY(40px);
  transition: all 1s cubic-bezier(0.16, 1, 0.3, 1);
}
.story-text.visible {
  opacity: 1;
  transform: translateY(0);
}
.story-tag {
  font-family: var(--font-mono);
  font-size: 0.6rem;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: var(--accent);
  margin-bottom: 20px;
}
.story-title {
  font-family: var(--font-display);
  font-size: clamp(2.2rem, 4vw, 3.5rem);
  letter-spacing: 3px;
  line-height: 1;
  margin-bottom: 28px;
}
.story-body {
  font-family: var(--font-serif);
  font-size: 1.05rem;
  font-weight: 300;
  line-height: 1.9;
  color: var(--cream-dim);
  max-width: 440px;
}
.story-body strong {
  color: var(--cream);
  font-weight: 400;
}

.story-visual {
  position: relative;
  opacity: 0;
  transform: translateY(40px) scale(0.97);
  transition: all 1.2s cubic-bezier(0.16, 1, 0.3, 1) 0.15s;
}
.story-visual.visible {
  opacity: 1;
  transform: translateY(0) scale(1);
}

/* Material cards */
.material-showcase {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
.material-card {
  position: relative;
  aspect-ratio: 1;
  border-radius: 16px;
  overflow: hidden;
  background: var(--surface);
  display: flex;
  flex-direction: column;
  justify-content: flex-end;
  padding: 16px;
  cursor: pointer;
  transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
}
.material-card:hover { transform: scale(1.03); }
.material-card canvas {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: 0;
}
.material-card .mat-label {
  position: relative;
  z-index: 1;
  font-family: var(--font-mono);
  font-size: 0.55rem;
  letter-spacing: 3px;
  text-transform: uppercase;
  color: var(--cream);
}

/* ═══ Color Picker Section ═══ */
#colorway-section {
  padding: 140px 6vw;
  text-align: center;
  position: relative;
}
.colorway-header {
  margin-bottom: 60px;
}
.colorway-header .story-tag { display: block; margin-bottom: 16px; }
.colorway-header .story-title { margin-bottom: 0; }

.colorway-grid {
  display: flex;
  justify-content: center;
  gap: 24px;
  flex-wrap: wrap;
  margin-bottom: 60px;
}
.color-option {
  width: 72px; height: 72px;
  border-radius: 50%;
  border: 3px solid transparent;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}
.color-option::after {
  content: '';
  width: 56px; height: 56px;
  border-radius: 50%;
  transition: transform 0.3s;
}
.color-option:hover::after { transform: scale(1.1); }
.color-option.active { border-color: var(--cream); }
.color-option:nth-child(1)::after { background: linear-gradient(135deg, #1a1a1a, #333); }
.color-option:nth-child(2)::after { background: linear-gradient(135deg, #f0ebe3, #c8c0b4); }
.color-option:nth-child(3)::after { background: linear-gradient(135deg, #ff4d00, #cc3300); }
.color-option:nth-child(4)::after { background: linear-gradient(135deg, #2a4a8a, #1a2a5a); }
.color-option:nth-child(5)::after { background: linear-gradient(135deg, #3a6a3a, #1a3a1a); }

.color-name {
  font-family: var(--font-mono);
  font-size: 0.7rem;
  letter-spacing: 3px;
  color: var(--cream-dim);
  text-transform: uppercase;
  margin-bottom: 4px;
}
.color-subtitle {
  font-family: var(--font-serif);
  font-size: 0.9rem;
  font-style: italic;
  color: rgba(240,235,227,0.3);
}

/* 3D Viewer for color section */
#color-viewer {
  width: 100%;
  max-width: 600px;
  height: 400px;
  margin: 0 auto;
  position: relative;
}

/* ═══ Size Selector ═══ */
#purchase-section {
  padding: 100px 6vw 140px;
  max-width: 900px;
  margin: 0 auto;
}
.purchase-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 60px;
  align-items: start;
}
.size-label {
  font-family: var(--font-mono);
  font-size: 0.6rem;
  letter-spacing: 4px;
  text-transform: uppercase;
  color: var(--cream-dim);
  margin-bottom: 20px;
}
.size-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 8px;
  margin-bottom: 32px;
}
.size-btn {
  padding: 14px 8px;
  background: transparent;
  border: 1px solid rgba(240,235,227,0.12);
  border-radius: 8px;
  color: var(--cream);
  font-family: var(--font-mono);
  font-size: 0.75rem;
  cursor: pointer;
  transition: all 0.3s;
}
.size-btn:hover {
  border-color: var(--cream-dim);
  background: rgba(240,235,227,0.03);
}
.size-btn.active {
  border-color: var(--accent);
  background: var(--accent-glow);
  color: var(--accent);
}
.size-btn.unavailable {
  opacity: 0.25;
  pointer-events: none;
  text-decoration: line-through;
}

.buy-btn {
  width: 100%;
  padding: 20px;
  background: var(--cream);
  color: var(--bg);
  border: none;
  border-radius: 12px;
  font-family: var(--font-display);
  font-size: 1.1rem;
  letter-spacing: 6px;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  position: relative;
  overflow: hidden;
}
.buy-btn::before {
  content: '';
  position: absolute;
  top: 0; left: -100%;
  width: 100%; height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,77,0,0.2), transparent);
  transition: left 0.6s;
}
.buy-btn:hover::before { left: 100%; }
.buy-btn:hover {
  background: var(--accent);
  color: var(--cream);
  transform: translateY(-2px);
  box-shadow: 0 12px 40px rgba(255, 77, 0, 0.25);
}

.purchase-info { padding-top: 8px; }
.info-row {
  display: flex;
  justify-content: space-between;
  padding: 16px 0;
  border-bottom: 1px solid rgba(240,235,227,0.06);
  font-family: var(--font-mono);
  font-size: 0.7rem;
  letter-spacing: 1px;
}
.info-row .label { color: var(--cream-dim); text-transform: uppercase; letter-spacing: 2px; }
.info-row .value { color: var(--cream); }

/* ═══ Specs Marquee ═══ */
.specs-marquee {
  padding: 40px 0;
  overflow: hidden;
  border-top: 1px solid rgba(240,235,227,0.06);
  border-bottom: 1px solid rgba(240,235,227,0.06);
}
.marquee-track {
  display: flex;
  gap: 60px;
  animation: marquee 30s linear infinite;
  width: max-content;
}
.marquee-item {
  font-family: var(--font-display);
  font-size: 1.3rem;
  letter-spacing: 6px;
  color: rgba(240,235,227,0.15);
  white-space: nowrap;
  flex-shrink: 0;
}
.marquee-item .dot {
  display: inline-block;
  width: 4px; height: 4px;
  border-radius: 50%;
  background: var(--accent);
  margin: 0 24px;
  vertical-align: middle;
}
@keyframes marquee {
  0% { transform: translateX(0); }
  100% { transform: translateX(-50%); }
}

/* ═══ Footer ═══ */
footer {
  padding: 60px 6vw;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-top: 1px solid rgba(240,235,227,0.06);
}
.footer-logo {
  font-family: var(--font-display);
  font-size: 1rem;
  letter-spacing: 6px;
}
.footer-links {
  display: flex;
  gap: 24px;
}
.footer-links a {
  font-family: var(--font-mono);
  font-size: 0.6rem;
  color: var(--cream-dim);
  text-decoration: none;
  letter-spacing: 2px;
  text-transform: uppercase;
  transition: color 0.3s;
}
.footer-links a:hover { color: var(--cream); }

/* ═══ Toast ═══ */
#toast {
  position: fixed;
  bottom: 40px; left: 50%;
  transform: translateX(-50%) translateY(100px);
  background: var(--surface);
  border: 1px solid rgba(255,77,0,0.2);
  border-radius: 12px;
  padding: 16px 28px;
  font-family: var(--font-mono);
  font-size: 0.7rem;
  letter-spacing: 2px;
  color: var(--cream);
  z-index: 200;
  transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
  backdrop-filter: blur(20px);
}
#toast.show { transform: translateX(-50%) translateY(0); }
#toast .toast-icon { color: var(--success); margin-right: 8px; }

/* ═══ Grain Overlay ═══ */
.grain {
  position: fixed;
  top: -50%; left: -50%;
  width: 200%; height: 200%;
  z-index: 9998;
  pointer-events: none;
  opacity: 0.025;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
  animation: grain-shift 0.5s steps(1) infinite;
}
@keyframes grain-shift {
  0% { transform: translate(0,0); }
  25% { transform: translate(-5%,-5%); }
  50% { transform: translate(5%,2%); }
  75% { transform: translate(-2%,5%); }
  100% { transform: translate(0,0); }
}

/* ═══ Responsive ═══ */
@media (max-width: 900px) {
  nav { padding: 16px 20px; }
  .nav-links { display: none; }
  #hero { flex-direction: column; height: auto; min-height: 100vh; }
  .hero-content { width: 100%; padding: 120px 24px 20px; text-align: center; }
  .hero-subtitle { margin: 0 auto 30px; }
  .hero-price-row { justify-content: center; }
  #viewer-container { position: relative; width: 100%; height: 50vh; }
  .viewer-hint { bottom: 20px; }
  .story-grid, .story-grid.reverse { grid-template-columns: 1fr; gap: 40px; direction: ltr; }
  .section-number { font-size: 6rem; right: 20px; top: 40px; }
  .purchase-grid { grid-template-columns: 1fr; }
  .hero-bg-text { font-size: 10rem; }
  footer { flex-direction: column; gap: 20px; text-align: center; }
  .cursor-dot, .cursor-ring { display: none; }
}
</style>
</head>
<body>

<div class="cursor-dot" id="cursorDot"></div>
<div class="cursor-ring" id="cursorRing"></div>
<div class="grain"></div>

<!-- ═══ Navigation ═══ -->
<nav>
  <a href="#" class="nav-logo">VOID RUNNER™</a>
  <ul class="nav-links">
    <li><a href="#story-1" data-hover>设计理念</a></li>
    <li><a href="#colorway-section" data-hover>配色方案</a></li>
    <li><a href="#purchase-section" data-hover>立即购买</a></li>
  </ul>
</nav>

<!-- ═══ Hero ═══ -->
<section id="hero">
  <div class="hero-bg-text">VOID</div>
  <div class="hero-content">
    <div class="hero-label">2026 限定发售 · 全球限量 5,000 双</div>
    <h1 class="hero-title">VOID<br>RUNNER</h1>
    <p class="hero-subtitle">当虚空被注入引力，每一步都在重塑地面。<br>碳纤维编织鞋面，自适应缓震中底。</p>
    <div class="hero-price-row">
      <span class="hero-price">¥2,499</span>
      <span class="hero-price-note">含税 · 包邮</span>
    </div>
  </div>
  <div id="viewer-container">
    <div class="viewer-hint"><span>↻</span> 拖拽旋转 · 滚轮缩放</div>
  </div>
  <div class="scroll-indicator">
    <div class="scroll-line"></div>
  </div>
</section>

<!-- ═══ Specs Marquee ═══ -->
<div class="specs-marquee">
  <div class="marquee-track" id="marquee-track">
    <span class="marquee-item">碳纤维编织鞋面 <span class="dot"></span></span>
    <span class="marquee-item">VOID-FOAM™ 自适应中底 <span class="dot"></span></span>
    <span class="marquee-item">3D 打印碳板 <span class="dot"></span></span>
    <span class="marquee-item">290 克超轻构造 <span class="dot"></span></span>
    <span class="marquee-item">零重力缓震系统 <span class="dot"></span></span>
    <span class="marquee-item">可回收材料 72% <span class="dot"></span></span>
    <span class="marquee-item">碳纤维编织鞋面 <span class="dot"></span></span>
    <span class="marquee-item">VOID-FOAM™ 自适应中底 <span class="dot"></span></span>
    <span class="marquee-item">3D 打印碳板 <span class="dot"></span></span>
    <span class="marquee-item">290 克超轻构造 <span class="dot"></span></span>
    <span class="marquee-item">零重力缓震系统 <span class="dot"></span></span>
    <span class="marquee-item">可回收材料 72% <span class="dot"></span></span>
  </div>
</div>

<!-- ═══ Story 01: Design Philosophy ═══ -->
<section class="story-section" id="story-1">
  <div class="section-number">01</div>
  <div class="story-grid">
    <div class="story-text" data-reveal>
      <div class="story-tag">// 设计理念</div>
      <h2 class="story-title">源于虚空的<br>极致构造</h2>
      <p class="story-body">
        VOID RUNNER 的设计灵感来自 <strong>太空舱外活动服</strong> 的工程学原理 —— 
        在极端环境下保护人体，同时赋予绝对的灵活性。<br><br>
        鞋面采用 <strong>单层碳纤维编织技术</strong>，每平方厘米包含 2,400 根纤维丝，
        在提供极致包裹感的同时，透气性能提升了 40%。
      </p>
    </div>
    <div class="story-visual" data-reveal>
      <div class="material-showcase">
        <div class="material-card" id="mat-carbon">
          <canvas></canvas>
          <span class="mat-label">碳纤维编织</span>
        </div>
        <div class="material-card" id="mat-foam">
          <canvas></canvas>
          <span class="mat-label">VOID-FOAM™</span>
        </div>
        <div class="material-card" id="mat-plate">
          <canvas></canvas>
          <span class="mat-label">3D 碳板</span>
        </div>
        <div class="material-card" id="mat-sole">
          <canvas></canvas>
          <span class="mat-label">抗引力外底</span>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ═══ Story 02: Technology ═══ -->
<section class="story-section" id="story-2">
  <div class="section-number">02</div>
  <div class="story-grid reverse">
    <div class="story-text" data-reveal>
      <div class="story-tag">// 核心科技</div>
      <h2 class="story-title">VOID-FOAM™<br>缓震革命</h2>
      <p class="story-body">
        自主研发的 <strong>VOID-FOAM™ 中底材料</strong> 采用超临界发泡工艺，
        密度仅为传统 EVA 的 60%，能量回馈却高达 <strong>87%</strong>。<br><br>
        配合 <strong>3D 打印全掌碳板</strong>，根据足弓数据定制弧度，
        将每一步的推进力精准传递，让你感受前所未有的「踩屎感」。
      </p>
    </div>
    <div class="story-visual" data-reveal>
      <div style="position:relative; width:100%; aspect-ratio:1; background: var(--surface); border-radius: 20px; overflow: hidden;" id="tech-viz-container">
        <canvas id="tech-viz" style="width:100%; height:100%;"></canvas>
        <div style="position:absolute; bottom:20px; left:20px; right:20px;">
          <div style="display:flex; justify-content:space-between; margin-bottom:12px;">
            <span style="font-family:var(--font-mono); font-size:0.55rem; letter-spacing:3px; color:var(--accent); text-transform:uppercase;">能量回馈</span>
            <span style="font-family:var(--font-mono); font-size:0.55rem; letter-spacing:2px; color:var(--cream);">87%</span>
          </div>
          <div style="height:3px; background:rgba(240,235,227,0.08); border-radius:2px; overflow:hidden;">
            <div id="energy-bar" style="width:0%; height:100%; background:linear-gradient(90deg, var(--accent), #ff8844); border-radius:2px; transition: width 2s cubic-bezier(0.16,1,0.3,1);"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ═══ Story 03: Sustainability ═══ -->
<section class="story-section" id="story-3">
  <div class="section-number">03</div>
  <div class="story-grid">
    <div class="story-text" data-reveal>
      <div class="story-tag">// 可持续发展</div>
      <h2 class="story-title">为地球而造<br>为未来而生</h2>
      <p class="story-body">
        VOID RUNNER 的 <strong>72% 材料来自可回收来源</strong>。鞋面编织纤维由海洋回收塑料制成，
        中底泡沫采用植物基 TPU，鞋盒使用 100% 再生纸板。<br><br>
        我们承诺：每售出一双 VOID RUNNER，将种植 <strong>3 棵红树林</strong>，
        用以抵消产品全生命周期的碳足迹。这不只是一双鞋，更是一份宣言。
      </p>
    </div>
    <div class="story-visual" data-reveal>
      <div style="position:relative; width:100%; aspect-ratio:1; background:var(--surface); border-radius:20px; overflow:hidden; display:flex; flex-direction:column; justify-content:center; padding:40px;">
        <div class="eco-stats">
          <div class="eco-stat" style="margin-bottom:36px;">
            <div style="font-family:var(--font-display); font-size:clamp(3rem,6vw,5rem); line-height:1; letter-spacing:2px; color:var(--cream);" data-count="72">0<span style="font-size:0.6em;">%</span></div>
            <div style="font-family:var(--font-mono); font-size:0.6rem; letter-spacing:3px; color:var(--cream-dim); text-transform:uppercase; margin-top:8px;">可回收材料占比</div>
          </div>
          <div class="eco-stat" style="margin-bottom:36px;">
            <div style="font-family:var(--font-display); font-size:clamp(3rem,6vw,5rem); line-height:1; letter-spacing:2px; color:var(--accent);" data-count="3">0</div>
            <div style="font-family:var(--font-mono); font-size:0.6rem; letter-spacing:3px; color:var(--cream-dim); text-transform:uppercase; margin-top:8px;">每双鞋种植红树林（棵）</div>
          </div>
          <div class="eco-stat">
            <div style="font-family:var(--font-display); font-size:clamp(3rem,6vw,5rem); line-height:1; letter-spacing:2px; color:var(--cream);" data-count="290">0<span style="font-size:0.6em;">g</span></div>
            <div style="font-family:var(--font-mono); font-size:0.6rem; letter-spacing:3px; color:var(--cream-dim); text-transform:uppercase; margin-top:8px;">单只鞋重</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ═══ Colorway Section ═══ -->
<section id="colorway-section">
  <div class="colorway-header" data-reveal>
    <span class="story-tag">// 配色方案</span>
    <h2 class="story-title">选择你的<br>引力场</h2>
  </div>
  <div class="colorway-grid">
    <div class="color-option active" data-color="void-black" onclick="selectColor(0)"></div>
    <div class="color-option" data-color="lunar-cream" onclick="selectColor(1)"></div>
    <div class="color-option" data-color="solar-flare" onclick="selectColor(2)"></div>
    <div class="color-option" data-color="deep-orbit" onclick="selectColor(3)"></div>
    <div class="color-option" data-color="terra-green" onclick="selectColor(4)"></div>
  </div>
  <div class="color-name" id="color-name">VOID BLACK</div>
  <div class="color-subtitle" id="color-subtitle">经典暗黑，永不过时</div>
  <div id="color-viewer"></div>
</section>

<!-- ═══ Purchase Section ═══ -->
<section id="purchase-section">
  <div class="purchase-grid">
    <div>
      <div class="size-label">选择尺码 (EU)</div>
      <div class="size-grid" id="size-grid">
        <button class="size-btn" onclick="selectSize(this)">38</button>
        <button class="size-btn" onclick="selectSize(this)">39</button>
        <button class="size-btn" onclick="selectSize(this)">40</button>
        <button class="size-btn active" onclick="selectSize(this)">41</button>
        <button class="size-btn" onclick="selectSize(this)">42</button>
        <button class="size-btn" onclick="selectSize(this)">43</button>
        <button class="size-btn" onclick="selectSize(this)">44</button>
        <button class="size-btn unavailable">45</button>
      </div>
      <button class="buy-btn" id="buy-btn" data-hover onclick="handleBuy()">立即购买 — ¥2,499</button>
    </div>
    <div class="purchase-info">
      <div class="info-row">
        <span class="label">发售日期</span>
        <span class="value">2026.03.01</span>
      </div>
      <div class="info-row">
        <span class="label">全球限量</span>
        <span class="value">5,000 双</span>
      </div>
      <div class="info-row">
        <span class="label">配送方式</span>
        <span class="value">顺丰特快 · 48h 达</span>
      </div>
      <div class="info-row">
        <span class="label">退换政策</span>
        <span class="value">7天无理由退换</span>
      </div>
      <div class="info-row">
        <span class="label">保修</span>
        <span class="value">2 年质量保证</span>
      </div>
    </div>
  </div>
</section>

<!-- ═══ Footer ═══ -->
<footer>
  <span class="footer-logo">VOID RUNNER™</span>
  <div class="footer-links">
    <a href="#">关于品牌</a>
    <a href="#">尺码指南</a>
    <a href="#">售后服务</a>
    <a href="#">隐私政策</a>
  </div>
</footer>

<!-- ═══ Toast ═══ -->
<div id="toast"><span class="toast-icon">✓</span> <span id="toast-text"></span></div>

<!-- ═══ Three.js ═══ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
// ═══════════════════════════════════════════════════════════
// VOID RUNNER — 3D E-Commerce Experience
// ═══════════════════════════════════════════════════════════

// ── Cursor ────────────────────────────────────────────────
const cursorDot = document.getElementById('cursorDot');
const cursorRing = document.getElementById('cursorRing');
let mouseX = 0, mouseY = 0, ringX = 0, ringY = 0;

document.addEventListener('mousemove', e => {
  mouseX = e.clientX;
  mouseY = e.clientY;
  cursorDot.style.left = mouseX + 'px';
  cursorDot.style.top = mouseY + 'px';
});

function animateCursor() {
  ringX += (mouseX - ringX) * 0.15;
  ringY += (mouseY - ringY) * 0.15;
  cursorRing.style.left = ringX + 'px';
  cursorRing.style.top = ringY + 'px';
  requestAnimationFrame(animateCursor);
}
animateCursor();

document.querySelectorAll('[data-hover], a, button, .color-option, .material-card').forEach(el => {
  el.addEventListener('mouseenter', () => cursorRing.classList.add('hover'));
  el.addEventListener('mouseleave', () => cursorRing.classList.remove('hover'));
});

// ── Procedural Sneaker Model Builder ─────────────────────
function buildSneaker(scene, colorConfig) {
  const group = new THREE.Group();
  const c = colorConfig || {
    upper: 0x1a1a1a, sole: 0x111111, accent: 0xff4d00,
    lace: 0x222222, inner: 0xff4d00
  };

  // Sole (multi-layered)
  const soleShape = new THREE.Shape();
  soleShape.moveTo(-0.55, 0);
  soleShape.quadraticCurveTo(-0.6, 0.6, -0.35, 1.5);
  soleShape.quadraticCurveTo(-0.15, 2.0, 0, 2.1);
  soleShape.quadraticCurveTo(0.15, 2.0, 0.35, 1.5);
  soleShape.quadraticCurveTo(0.6, 0.6, 0.55, 0);
  soleShape.quadraticCurveTo(0.3, -0.15, 0, -0.2);
  soleShape.quadraticCurveTo(-0.3, -0.15, -0.55, 0);

  const extrudeSettings = { depth: 0.25, bevelEnabled: true, bevelThickness: 0.05, bevelSize: 0.03, bevelSegments: 3 };
  const soleGeo = new THREE.ExtrudeGeometry(soleShape, extrudeSettings);
  const soleMat = new THREE.MeshStandardMaterial({ color: c.sole, roughness: 0.7, metalness: 0.1 });
  const sole = new THREE.Mesh(soleGeo, soleMat);
  sole.rotation.x = -Math.PI / 2;
  sole.position.y = 0;
  sole.castShadow = true;
  group.add(sole);

  // Midsole
  const midSoleGeo = new THREE.ExtrudeGeometry(soleShape, { depth: 0.35, bevelEnabled: true, bevelThickness: 0.08, bevelSize: 0.05, bevelSegments: 4 });
  const midSoleMat = new THREE.MeshStandardMaterial({ color: c.accent, roughness: 0.3, metalness: 0.2, emissive: c.accent, emissiveIntensity: 0.08 });
  const midSole = new THREE.Mesh(midSoleGeo, midSoleMat);
  midSole.rotation.x = -Math.PI / 2;
  midSole.position.y = 0.25;
  midSole.scale.set(0.95, 0.95, 1);
  midSole.castShadow = true;
  group.add(midSole);

  // Upper shoe body
  const upperShape = new THREE.Shape();
  upperShape.moveTo(-0.45, 0);
  upperShape.quadraticCurveTo(-0.5, 0.5, -0.28, 1.35);
  upperShape.quadraticCurveTo(-0.1, 1.8, 0, 1.85);
  upperShape.quadraticCurveTo(0.1, 1.8, 0.28, 1.35);
  upperShape.quadraticCurveTo(0.5, 0.5, 0.45, 0);
  upperShape.quadraticCurveTo(0.25, -0.1, 0, -0.13);
  upperShape.quadraticCurveTo(-0.25, -0.1, -0.45, 0);

  const upperGeo = new THREE.ExtrudeGeometry(upperShape, { depth: 0.6, bevelEnabled: true, bevelThickness: 0.1, bevelSize: 0.06, bevelSegments: 5 });
  const upperMat = new THREE.MeshStandardMaterial({ color: c.upper, roughness: 0.5, metalness: 0.3 });
  const upper = new THREE.Mesh(upperGeo, upperMat);
  upper.rotation.x = -Math.PI / 2;
  upper.position.y = 0.55;
  upper.scale.set(0.88, 0.88, 1);
  upper.castShadow = true;
  group.add(upper);

  // Collar
  const collarGeo = new THREE.TorusGeometry(0.32, 0.08, 8, 24, Math.PI * 1.4);
  const collarMat = new THREE.MeshStandardMaterial({ color: c.inner, roughness: 0.4, metalness: 0.2 });
  const collar = new THREE.Mesh(collarGeo, collarMat);
  collar.position.set(0, 1.1, -0.15);
  collar.rotation.x = Math.PI * 0.1;
  collar.rotation.z = Math.PI * 0.15;
  group.add(collar);

  // Lace loops
  for (let i = 0; i < 5; i++) {
    const loopGeo = new THREE.TorusGeometry(0.04, 0.012, 6, 12);
    const loopMat = new THREE.MeshStandardMaterial({ color: c.lace, roughness: 0.6 });
    const loopL = new THREE.Mesh(loopGeo, loopMat);
    loopL.position.set(-0.12, 0.9 + i * 0.08, 0.55 - i * 0.18);
    loopL.rotation.y = Math.PI / 2;
    group.add(loopL);
    const loopR = loopL.clone();
    loopR.position.x = 0.12;
    group.add(loopR);
  }

  // Lace string
  const lacePts = [];
  for (let i = 0; i < 5; i++) {
    lacePts.push(new THREE.Vector3(-0.12, 0.9 + i * 0.08, 0.55 - i * 0.18));
    lacePts.push(new THREE.Vector3(0.12, 0.9 + i * 0.08 + 0.04, 0.55 - i * 0.18 - 0.09));
  }
  const laceCurve = new THREE.CatmullRomCurve3(lacePts);
  const laceGeo = new THREE.TubeGeometry(laceCurve, 32, 0.012, 6, false);
  const laceMat = new THREE.MeshStandardMaterial({ color: c.lace, roughness: 0.8 });
  group.add(new THREE.Mesh(laceGeo, laceMat));

  // Toe bumper
  const toeGeo = new THREE.SphereGeometry(0.35, 16, 12, 0, Math.PI * 2, 0, Math.PI / 2);
  const toeMat = new THREE.MeshStandardMaterial({ color: c.upper, roughness: 0.4, metalness: 0.4 });
  const toe = new THREE.Mesh(toeGeo, toeMat);
  toe.position.set(0, 0.6, 1.5);
  toe.scale.set(1.1, 0.8, 1.2);
  toe.castShadow = true;
  group.add(toe);

  // Heel tab
  const heelGeo = new THREE.BoxGeometry(0.2, 0.3, 0.05);
  const heelMat = new THREE.MeshStandardMaterial({ color: c.accent, roughness: 0.3, emissive: c.accent, emissiveIntensity: 0.15 });
  const heel = new THREE.Mesh(heelGeo, heelMat);
  heel.position.set(0, 1.05, -0.5);
  group.add(heel);

  // Logo on side — small glowing strip
  const stripGeo = new THREE.BoxGeometry(0.02, 0.06, 0.7);
  const stripMat = new THREE.MeshBasicMaterial({ color: c.accent });
  const stripL = new THREE.Mesh(stripGeo, stripMat);
  stripL.position.set(-0.48, 0.75, 0.4);
  group.add(stripL);
  const stripR = stripL.clone();
  stripR.position.x = 0.48;
  group.add(stripR);

  group.rotation.y = -Math.PI * 0.25;
  group.position.y = -0.4;
  scene.add(group);
  return group;
}

// ── Color Configs ────────────────────────────────────────
const COLOR_CONFIGS = [
  { name: 'VOID BLACK', subtitle: '经典暗黑，永不过时', upper: 0x1a1a1a, sole: 0x111111, accent: 0xff4d00, lace: 0x222222, inner: 0xff4d00 },
  { name: 'LUNAR CREAM', subtitle: '月球表面，温柔触感', upper: 0xe8e0d4, sole: 0xd4ccc0, accent: 0x1a1a1a, lace: 0xc8c0b4, inner: 0x1a1a1a },
  { name: 'SOLAR FLARE', subtitle: '太阳耀斑，燃烧激情', upper: 0xff4d00, sole: 0xcc3300, accent: 0xffffff, lace: 0xff6622, inner: 0xffffff },
  { name: 'DEEP ORBIT', subtitle: '深空蓝，静谧无垠', upper: 0x1a2a5a, sole: 0x111833, accent: 0x44aaff, lace: 0x223366, inner: 0x44aaff },
  { name: 'TERRA GREEN', subtitle: '大地之绿，自然之声', upper: 0x2a4a2a, sole: 0x1a331a, accent: 0x88dd44, lace: 0x335533, inner: 0x88dd44 },
];

// ── Hero 3D Viewer ───────────────────────────────────────
let heroScene, heroCamera, heroRenderer, heroSneaker, heroControls;

(function initHeroViewer() {
  const container = document.getElementById('viewer-container');
  heroScene = new THREE.Scene();

  heroCamera = new THREE.PerspectiveCamera(35, container.clientWidth / container.clientHeight, 0.1, 100);
  heroCamera.position.set(2.5, 2, 3.5);

  heroRenderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
  heroRenderer.setSize(container.clientWidth, container.clientHeight);
  heroRenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
  heroRenderer.shadowMap.enabled = true;
  heroRenderer.shadowMap.type = THREE.PCFSoftShadowMap;
  heroRenderer.toneMapping = THREE.ACESFilmicToneMapping;
  heroRenderer.toneMappingExposure = 1.0;
  container.appendChild(heroRenderer.domElement);

  // Lighting
  const ambient = new THREE.AmbientLight(0x404050, 0.6);
  heroScene.add(ambient);

  const key = new THREE.DirectionalLight(0xffffff, 1.0);
  key.position.set(3, 5, 4);
  key.castShadow = true;
  key.shadow.mapSize.set(1024, 1024);
  key.shadow.camera.near = 0.5;
  key.shadow.camera.far = 20;
  heroScene.add(key);

  const fill = new THREE.DirectionalLight(0xff6633, 0.4);
  fill.position.set(-4, 3, -2);
  heroScene.add(fill);

  const rim = new THREE.DirectionalLight(0x4488ff, 0.5);
  rim.position.set(0, 2, -5);
  heroScene.add(rim);

  const bottomLight = new THREE.PointLight(0xff4d00, 0.4, 8);
  bottomLight.position.set(0, -1, 0);
  heroScene.add(bottomLight);

  // Ground shadow catcher
  const shadowGeo = new THREE.PlaneGeometry(4, 4);
  const shadowMat = new THREE.ShadowMaterial({ opacity: 0.3 });
  const shadowPlane = new THREE.Mesh(shadowGeo, shadowMat);
  shadowPlane.rotation.x = -Math.PI / 2;
  shadowPlane.position.y = -0.4;
  shadowPlane.receiveShadow = true;
  heroScene.add(shadowPlane);

  heroSneaker = buildSneaker(heroScene, COLOR_CONFIGS[0]);
  heroCamera.lookAt(0, 0.3, 0);

  // Orbit interaction
  let isDragging = false, prevX = 0, prevY = 0;
  let rotY = heroSneaker.rotation.y, rotX = 0;
  let targetRotY = rotY, targetRotX = 0;
  let autoRotate = true;

  heroRenderer.domElement.addEventListener('pointerdown', e => {
    isDragging = true;
    autoRotate = false;
    prevX = e.clientX;
    prevY = e.clientY;
  });
  window.addEventListener('pointerup', () => { isDragging = false; });
  window.addEventListener('pointermove', e => {
    if (!isDragging) return;
    const dx = e.clientX - prevX;
    const dy = e.clientY - prevY;
    targetRotY += dx * 0.008;
    targetRotX = Math.max(-0.4, Math.min(0.4, targetRotX + dy * 0.005));
    prevX = e.clientX;
    prevY = e.clientY;
  });

  // Zoom
  heroRenderer.domElement.addEventListener('wheel', e => {
    const z = heroCamera.position.length();
    const factor = 1 + e.deltaY * 0.001;
    const newZ = Math.max(2.5, Math.min(7, z * factor));
    heroCamera.position.normalize().multiplyScalar(newZ);
  }, { passive: true });

  // Touch
  let touchPrevX = 0, touchPrevY = 0;
  heroRenderer.domElement.addEventListener('touchstart', e => {
    isDragging = true;
    autoRotate = false;
    touchPrevX = e.touches[0].clientX;
    touchPrevY = e.touches[0].clientY;
  }, { passive: true });
  heroRenderer.domElement.addEventListener('touchmove', e => {
    if (!isDragging || !e.touches.length) return;
    const dx = e.touches[0].clientX - touchPrevX;
    const dy = e.touches[0].clientY - touchPrevY;
    targetRotY += dx * 0.008;
    targetRotX = Math.max(-0.4, Math.min(0.4, targetRotX + dy * 0.005));
    touchPrevX = e.touches[0].clientX;
    touchPrevY = e.touches[0].clientY;
  }, { passive: true });
  heroRenderer.domElement.addEventListener('touchend', () => { isDragging = false; });

  function animateHero() {
    requestAnimationFrame(animateHero);
    if (autoRotate) targetRotY += 0.004;
    rotY += (targetRotY - rotY) * 0.08;
    rotX += (targetRotX - rotX) * 0.08;
    if (heroSneaker) {
      heroSneaker.rotation.y = rotY;
      heroSneaker.rotation.x = rotX;
      heroSneaker.position.y = -0.4 + Math.sin(Date.now() * 0.001) * 0.05;
    }
    heroRenderer.render(heroScene, heroCamera);
  }
  animateHero();

  window.addEventListener('resize', () => {
    heroCamera.aspect = container.clientWidth / container.clientHeight;
    heroCamera.updateProjectionMatrix();
    heroRenderer.setSize(container.clientWidth, container.clientHeight);
  });
})();

// ── Colorway Viewer ──────────────────────────────────────
let colorScene, colorCamera, colorRenderer, colorSneaker;
let colorAutoRotY = -Math.PI * 0.25;

(function initColorViewer() {
  const container = document.getElementById('color-viewer');
  colorScene = new THREE.Scene();

  colorCamera = new THREE.PerspectiveCamera(35, container.clientWidth / Math.max(container.clientHeight, 400), 0.1, 100);
  colorCamera.position.set(2.5, 1.8, 3.5);
  colorCamera.lookAt(0, 0.3, 0);

  colorRenderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
  colorRenderer.setSize(container.clientWidth, 400);
  colorRenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
  colorRenderer.toneMapping = THREE.ACESFilmicToneMapping;
  container.appendChild(colorRenderer.domElement);

  const ambient = new THREE.AmbientLight(0x404050, 0.6);
  colorScene.add(ambient);
  const key = new THREE.DirectionalLight(0xffffff, 1.0);
  key.position.set(3, 5, 4);
  colorScene.add(key);
  const fill = new THREE.DirectionalLight(0xff6633, 0.3);
  fill.position.set(-4, 3, -2);
  colorScene.add(fill);

  colorSneaker = buildSneaker(colorScene, COLOR_CONFIGS[0]);

  function animateColor() {
    requestAnimationFrame(animateColor);
    colorAutoRotY += 0.005;
    if (colorSneaker) {
      colorSneaker.rotation.y = colorAutoRotY;
      colorSneaker.position.y = -0.4 + Math.sin(Date.now() * 0.0012) * 0.04;
    }
    colorRenderer.render(colorScene, colorCamera);
  }
  animateColor();
})();

function selectColor(idx) {
  document.querySelectorAll('.color-option').forEach((el, i) => {
    el.classList.toggle('active', i === idx);
  });
  document.getElementById('color-name').textContent = COLOR_CONFIGS[idx].name;
  document.getElementById('color-subtitle').textContent = COLOR_CONFIGS[idx].subtitle;

  // Rebuild sneaker with new color
  if (colorSneaker) {
    colorScene.remove(colorSneaker);
    colorSneaker.traverse(child => {
      if (child.geometry) child.geometry.dispose();
      if (child.material) child.material.dispose();
    });
  }
  colorSneaker = buildSneaker(colorScene, COLOR_CONFIGS[idx]);
  colorSneaker.rotation.y = colorAutoRotY;
}

// ── Material Textures (procedural canvas) ────────────────
function drawMaterialTexture(canvasEl, type) {
  const canvas = canvasEl;
  const s = 256;
  canvas.width = s; canvas.height = s;
  const ctx = canvas.getContext('2d');

  if (type === 'carbon') {
    ctx.fillStyle = '#111';
    ctx.fillRect(0, 0, s, s);
    for (let y = 0; y < s; y += 6) {
      for (let x = 0; x < s; x += 6) {
        const offset = (Math.floor(y / 6) % 2) * 3;
        const brightness = 20 + Math.random() * 30;
        ctx.fillStyle = `rgb(${brightness},${brightness},${brightness + 10})`;
        ctx.fillRect(x + offset, y, 5, 5);
      }
    }
    // Sheen
    const g = ctx.createLinearGradient(0, 0, s, s);
    g.addColorStop(0, 'rgba(255,77,0,0)');
    g.addColorStop(0.5, 'rgba(255,77,0,0.06)');
    g.addColorStop(1, 'rgba(255,77,0,0)');
    ctx.fillStyle = g;
    ctx.fillRect(0, 0, s, s);
  } else if (type === 'foam') {
    ctx.fillStyle = '#1a1a1a';
    ctx.fillRect(0, 0, s, s);
    for (let i = 0; i < 600; i++) {
      const x = Math.random() * s;
      const y = Math.random() * s;
      const r = 1 + Math.random() * 8;
      ctx.beginPath();
      ctx.arc(x, y, r, 0, Math.PI * 2);
      ctx.fillStyle = `rgba(255,77,0,${0.03 + Math.random() * 0.05})`;
      ctx.fill();
    }
    ctx.fillStyle = 'rgba(255,77,0,0.03)';
    ctx.fillRect(0, 0, s, s);
  } else if (type === 'plate') {
    ctx.fillStyle = '#0a0a0a';
    ctx.fillRect(0, 0, s, s);
    ctx.strokeStyle = 'rgba(255,77,0,0.12)';
    ctx.lineWidth = 0.5;
    for (let i = 0; i < 40; i++) {
      const y = (i / 40) * s;
      ctx.beginPath();
      ctx.moveTo(0, y);
      for (let x = 0; x < s; x += 4) {
        ctx.lineTo(x, y + Math.sin(x * 0.05 + i) * 3);
      }
      ctx.stroke();
    }
    const rg = ctx.createRadialGradient(s / 2, s / 2, 0, s / 2, s / 2, s / 2);
    rg.addColorStop(0, 'rgba(255,77,0,0.08)');
    rg.addColorStop(1, 'rgba(0,0,0,0)');
    ctx.fillStyle = rg;
    ctx.fillRect(0, 0, s, s);
  } else if (type === 'sole') {
    ctx.fillStyle = '#0d0d0d';
    ctx.fillRect(0, 0, s, s);
    // Hexagonal tread
    const hexR = 12;
    for (let row = 0; row < s / (hexR * 1.5); row++) {
      for (let col = 0; col < s / (hexR * 1.8); col++) {
        const cx = col * hexR * 1.8 + (row % 2 ? hexR * 0.9 : 0);
        const cy = row * hexR * 1.5;
        ctx.beginPath();
        for (let j = 0; j < 6; j++) {
          const angle = (Math.PI / 3) * j - Math.PI / 6;
          const hx = cx + hexR * 0.8 * Math.cos(angle);
          const hy = cy + hexR * 0.8 * Math.sin(angle);
          j === 0 ? ctx.moveTo(hx, hy) : ctx.lineTo(hx, hy);
        }
        ctx.closePath();
        ctx.strokeStyle = `rgba(255,77,0,${0.08 + Math.random() * 0.08})`;
        ctx.lineWidth = 0.5;
        ctx.stroke();
      }
    }
  }
}

document.querySelectorAll('.material-card').forEach(card => {
  const canvas = card.querySelector('canvas');
  if (card.id === 'mat-carbon') drawMaterialTexture(canvas, 'carbon');
  if (card.id === 'mat-foam') drawMaterialTexture(canvas, 'foam');
  if (card.id === 'mat-plate') drawMaterialTexture(canvas, 'plate');
  if (card.id === 'mat-sole') drawMaterialTexture(canvas, 'sole');
});

// ── Tech Visualization (energy particles) ────────────────
(function initTechViz() {
  const canvas = document.getElementById('tech-viz');
  const container = document.getElementById('tech-viz-container');
  const ctx = canvas.getContext('2d');
  canvas.width = 500;
  canvas.height = 500;

  const particles = [];
  for (let i = 0; i < 120; i++) {
    particles.push({
      x: Math.random() * 500,
      y: Math.random() * 500,
      vx: (Math.random() - 0.5) * 0.8,
      vy: (Math.random() - 0.5) * 0.8,
      r: 1.5 + Math.random() * 2.5,
      hue: Math.random() > 0.5 ? 18 : 30,
    });
  }

  function drawTechViz() {
    requestAnimationFrame(drawTechViz);
    ctx.fillStyle = 'rgba(26,26,26,0.15)';
    ctx.fillRect(0, 0, 500, 500);

    particles.forEach(p => {
      p.x += p.vx;
      p.y += p.vy;
      if (p.x < 0 || p.x > 500) p.vx *= -1;
      if (p.y < 0 || p.y > 500) p.vy *= -1;

      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
      ctx.fillStyle = `hsla(${p.hue}, 100%, 55%, 0.6)`;
      ctx.fill();

      // Connect nearby
      particles.forEach(q => {
        const dist = Math.hypot(p.x - q.x, p.y - q.y);
        if (dist < 60 && dist > 0) {
          ctx.beginPath();
          ctx.moveTo(p.x, p.y);
          ctx.lineTo(q.x, q.y);
          ctx.strokeStyle = `hsla(18, 100%, 55%, ${0.08 * (1 - dist / 60)})`;
          ctx.lineWidth = 0.5;
          ctx.stroke();
        }
      });
    });
  }
  drawTechViz();
})();

// ── Scroll Animations ────────────────────────────────────
const revealElements = document.querySelectorAll('[data-reveal]');
const observerOptions = { threshold: 0.2, rootMargin: '0px 0px -50px 0px' };

const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      entry.target.classList.add('visible');

      // Energy bar animation
      if (entry.target.closest('#story-2')) {
        setTimeout(() => {
          const bar = document.getElementById('energy-bar');
          if (bar) bar.style.width = '87%';
        }, 300);
      }

      // Counter animation
      entry.target.querySelectorAll('[data-count]').forEach(el => {
        const target = parseInt(el.dataset.count);
        const suffix = el.innerHTML.includes('%') ? '%' : el.innerHTML.includes('g') ? 'g' : '';
        let current = 0;
        const step = Math.ceil(target / 40);
        const interval = setInterval(() => {
          current += step;
          if (current >= target) {
            current = target;
            clearInterval(interval);
          }
          el.innerHTML = current + (suffix ? `<span style="font-size:0.6em">${suffix}</span>` : '');
        }, 30);
      });

      observer.unobserve(entry.target);
    }
  });
}, observerOptions);

revealElements.forEach(el => observer.observe(el));

// ── Size Selection ───────────────────────────────────────
function selectSize(btn) {
  if (btn.classList.contains('unavailable')) return;
  document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
}

// ── Buy Button ───────────────────────────────────────────
function handleBuy() {
  const btn = document.getElementById('buy-btn');
  btn.textContent = '处理中…';
  btn.style.pointerEvents = 'none';

  setTimeout(() => {
    btn.textContent = '✓ 已加入购物袋';
    btn.style.background = '#2ecc71';
    btn.style.color = '#fff';
    showToast('VOID RUNNER 已加入购物袋');

    setTimeout(() => {
      btn.textContent = '立即购买 — ¥2,499';
      btn.style.background = '';
      btn.style.color = '';
      btn.style.pointerEvents = '';
    }, 3000);
  }, 1500);
}

function showToast(msg) {
  const toast = document.getElementById('toast');
  document.getElementById('toast-text').textContent = msg;
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 3000);
}

// ── Smooth scroll for nav links ──────────────────────────
document.querySelectorAll('nav a[href^="#"]').forEach(a => {
  a.addEventListener('click', e => {
    e.preventDefault();
    const target = document.querySelector(a.getAttribute('href'));
    if (target) target.scrollIntoView({ behavior: 'smooth' });
  });
});
</script>
</body>
</html>
